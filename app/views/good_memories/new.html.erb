<div class="max-w-2xl mx-auto">
  <div class="bg-white rounded-2xl shadow-lg p-8 border-4 border-pink-100">
    <div class="text-center mb-8">
      <h1 class="text-3xl font-bold text-pink-600 mb-2">新しい思い出を記録</h1>
      <p class="text-gray-600">今日の良かったことを思い出して記録しましょう</p>
    </div>

    <%= form_with model: @good_memory, local: true, class: "space-y-6" do |form| %>
      <% if @good_memory.errors.any? %>
        <div class="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg">
          <h2 class="font-semibold mb-2">以下のエラーがあります：</h2>
          <ul class="list-disc list-inside space-y-1">
            <% @good_memory.errors.full_messages.each do |message| %>
              <li><%= message %></li>
            <% end %>
          </ul>
        </div>
      <% end %>

      <div>
        <%= form.label :date, "日付", class: "block text-sm font-medium text-gray-700 mb-2" %>
        <%= form.date_field :date, class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500 transition-colors" %>
      </div>

      <div>
        <%= form.label :mood, "その日の気分", class: "block text-sm font-medium text-gray-700 mb-2" %>
        <div class="grid grid-cols-5 gap-3">
          <% GoodMemory.moods.each do |mood, value| %>
            <div class="text-center">
              <%= form.radio_button :mood, mood, class: "sr-only", id: "mood_#{mood}" %>
              <%= form.label "mood_#{mood}", class: "block cursor-pointer" do %>
                <div class="p-3 border-2 border-gray-200 rounded-lg hover:border-pink-300 transition-colors" data-mood-target>
                  <div class="text-2xl mb-1"><%= GoodMemory.new(mood: mood).mood_emoji %></div>
                  <div class="text-xs text-gray-600"><%= GoodMemory.new(mood: mood).mood_text %></div>
                </div>
              <% end %>
            </div>
          <% end %>
        </div>
      </div>

      <div>
        <%= form.label :content, "今日の良かったこと", class: "block text-sm font-medium text-gray-700 mb-2" %>
        <%= form.text_area :content, rows: 6, placeholder: "今日あった良かったことを自由に書いてください...", 
            class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500 transition-colors resize-none" %>
        <p class="text-sm text-gray-500 mt-1">例：家族と笑顔で過ごせた、美味しいお茶を飲んだ、友達から励ましのメッセージをもらったなど</p>
      </div>

      <div class="flex justify-center space-x-4 pt-6">
        <%= link_to "キャンセル", root_path, class: "px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors" %>
        <%= form.submit "思い出を保存", class: "px-6 py-3 bg-pink-500 hover:bg-pink-600 text-white rounded-lg font-semibold transition-colors shadow-lg" %>
      </div>
    <% end %>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const moodRadios = document.querySelectorAll('input[name="good_memory[mood]"]');
  const moodTargets = document.querySelectorAll('[data-mood-target]');

  moodRadios.forEach(radio => {
    radio.addEventListener('change', function() {
      // すべてのターゲットから選択状態を削除
      moodTargets.forEach(target => {
        target.classList.remove('border-pink-500', 'bg-pink-50');
        target.classList.add('border-gray-200');
      });

      // 選択されたターゲットに選択状態を追加
      if (this.checked) {
        const target = this.nextElementSibling.querySelector('[data-mood-target]');
        target.classList.remove('border-gray-200');
        target.classList.add('border-pink-500', 'bg-pink-50');
      }
    });
  });
});
</script>
